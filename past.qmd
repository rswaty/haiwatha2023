---
title: "Past"
---
LANDFIRE's [Biophysical Settings](https://landfire.gov/bps.php){target="blank"} (BpSs, aka "Historical Ecosystems") represent "the vegetation system that may have been dominant on the landscape prior to Euro-American settlement and is based on both the current biophysical environment and an approximation of the historical disturbance regime." (from https://landfire.gov/bps.php). We will use this data to explore the most prevalent BpSs in a chart and map, and also the historical disturbance data that are linked to the BpSs.

## Summary
Historically 10 historical ecosystems covered roughly 90% of the Hiawatha National Forest.  More specifically:

* Wetland types (primarily the 'Laurentian-Acadian Alkaline Conifer-Hardwood Swamp' and 'Boreal Acidic Peatland Systems') were present on > 40% of the area.
* The 'Laurentian-Acadian Northern Hardwoods Forest-Hemlock' ecosystem covered ~20% of the area
* Roughly 30% of the Hiawatha had ecosytems with Mean Fire Return Intervals (MFRI) of ~100 years or less, with ~10% having a MFRI of > 10 years.


## Chart of most prevalent Biophysical Settings

<br>


```{r bps chart, message=FALSE, warning=FALSE, echo=FALSE, fig.width=10}
library(tidyverse)
library(scales)

bps_data <- read.csv("data/bps_aoi_attributes.csv")

bpsname <- bps_data %>%
  group_by(BPS_NAME) %>%
  summarize(ACRES = sum(ACRES),
            REL_PERCENT = sum(REL_PERCENT)) %>%
  arrange(desc(REL_PERCENT)) %>%
  top_n(n = 10, wt = REL_PERCENT)

# plot
bpsChart <- 
  ggplot(data = bpsname, aes(x = BPS_NAME, y = REL_PERCENT)) +
  geom_bar(stat = "identity") +
  labs(
    title = "Top 10 Biophysical Settings",
    subtitle = "Represents dominant vegetation systems pre-European colonization",
    caption = "Data from landfire.gov.",
    x = "",
    y = "Percent of landscape") +
  scale_x_discrete(limits = rev(bpsname$BPS_NAME)) +
  coord_flip() +
  theme_bw()

bpsChart
```



## Map of most prevalent Biophysical Settings

<br>

![](images/bps_map.jpg){width=100%}

<br>

## Chart of historic annual acres burned per ecosystem

```{r fire bar, echo=FALSE, message=FALSE, warning=FALSE, fig.width=10}
# read bps attribute table .csv and summarize
annualFire <- bps_data %>%
  mutate(annual_fire_acres = ((1/FRI_ALLFIR)*ACRES)) %>%
  filter(BPS_NAME != 'Open Water') %>%
  group_by(BPS_NAME) %>%
  summarize(acres = sum(annual_fire_acres)) %>%
  arrange(desc(acres)) %>%
  top_n(n = 10, wt = acres)

# plot
fireChart <- 
  ggplot(data = annualFire, aes(x = BPS_NAME, y = acres)) +
  geom_bar(stat = "identity") +
  labs(
    title = "Historical Annual Acres Burned for the Deer Creek Landscape",
    subtitle = "Cumulative estimates of all fire types prior to pre-European colonization",
    caption = "\nData from landfire.gov.",
    x = "",
    y = "Acres") +
  scale_x_discrete(limits = rev(annualFire$BPS_NAME)) +
  scale_y_continuous(name = 'Acres', labels = comma) +
  coord_flip() +
  theme_bw()

fireChart

# if the plot looks good, save it
ggsave("./OUTPUTS/fireChart.png", width = 12, height = 5)
```

<br>

## Simplified map of historical fire regimes

![](images/mfri.jpg){width=100%}


## Data table

```{r bps data table, echo=FALSE, message=FALSE, warning=FALSE, fig.width=10}

# clean data
clean_bps_data <- bps_data[-c(1,17:22, 12:15, 1:4)] 
  
library(kableExtra)

kable(clean_bps_data,
      format.args = list(big.mark = ",")) %>%
  kable_styling(
    font_size = 10,
    bootstrap_options = c("striped", "hover", "condensed")
  ) 

```


